var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_exchangedata_start"),(self["suiteux_shell_webpackJsonp_suiteux-main"]=self["suiteux_shell_webpackJsonp_suiteux-main"]||[]).push([["exchangedata"],{49861:function(e,a,n){n.r(a),n.d(a,{getOwaUserConfig:function(){return h},setUserTheme:function(){return u}});var t,r=n(16968),i=n(44966),o=n(91336);!function(e){e.DataProviderOpxGetUserConfiguration="DataProviderOpxGetUserConfiguration",e.DataProviderOpxSaveUserTheme="DataProviderOpxSaveUserTheme"}(t||(t={}));var s=n(62853);const c="DataProviderOpx";let l=null;function h(){return new Promise(((e,a)=>{x().then((()=>{o.F.Instance.OwaPoweredExperiences.updateData(s.G.ExchangeData,t.DataProviderOpxGetUserConfiguration).then((a=>{(0,r.tZ)().impression("GetOwaUserConfigSuccess","ExchangeDataOpx"),e(a)}))})).catch((e=>{a(e)}))}))}function u(e,a){return new Promise(((n,i)=>{x().then((()=>{const i={ThemeId:e,SkipO365Call:a};(0,r.tZ)().tag("SetUserThemeStart",1,"ExchangeDataOpx",e),o.F.Instance.OwaPoweredExperiences.updateData(s.G.ExchangeData,t.DataProviderOpxSaveUserTheme,i).then((a=>{(0,r.tZ)().tag("SetUserThemeSuccess",1,"ExchangeDataOpx",e),n(a)}))})).catch((e=>{i(e)}))}))}function x(){return null==l&&(l=new Promise(((e,a)=>{const n=(0,i.Tu)();n?function(e){const a=document.createElement("iframe");a.id=c,a.name=c,e.appendChild(a);const n={AuthToken:"",UseDarkMode:!1,BackgroundColor:"",SessionId:"",Scenario:"DataProvider",Telemetry:JSON.stringify({SessionID:o.F.Instance.Configuration.ShellSID,WorkloadID:o.F.Instance.Configuration.WorkloadId}),Data:{}};return o.F.Instance.OwaPoweredExperiences.initializeOpx(s.G.ExchangeData,c,n)}(n).then((n=>{if(0===n)e();else(0,r.tZ)().tag("ExchangeDataOpx_InitializeExchangeDataOpx_Failed",6,n),a(`Failed to initialize Exchange Data OPX.  Result Code: ${n}`)})).catch((e=>{(0,r.tZ)().exception("ExchangeDataOpx_InitializeExchangeDataOpx_UnknownFailure",6,e),a(e)})):((0,r.tZ)().tag("ExchangeDataOpx_InitializeExchangeDataOpx_Failed",6,2),a("Failed to instantiate OPX container."))}))),l}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_exchangedata_end"),shellPerformance.measure("shell_exchangedata","shell_exchangedata_start","shell_exchangedata_end"));